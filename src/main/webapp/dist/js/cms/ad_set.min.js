function AdSet(){}AdSet.prototype.initModal=function(){myajax.get({url:"/cms/get_ads/",success:function(t){if(200===t.code){for(var n=t.data.ads,a=[0,0,0,0],i=0;i<n.length;i++){var e=template("adhtml",{ad:n[i]}),d=n[i].location;a[d-1]=1,$("[data-location='"+d+"']").append(e)}for(var o,l=0;l<4;l++){0===a[l]&&(o=template("adhtml",{ad:{location:l+1,image_url:"/static/images/novel/advertisement/blank.png",link_to:"",hint:"",id:0}}),$("[data-location='"+(l+1)+"']").append(o))}}}})},AdSet.prototype.listenChangeImageEvent=function(){var t=$(".thumbnail-btn");console.log(t),t.click(function(){var a=$(this).children("img"),t=$(this).parents(".modal-body").find(".image-file");t.change(function(){var t=$(this)[0].files[0],n=new FormData;n.append("file",t),myajax.post({url:"/cms/upload_file/",data:n,processData:!1,contentType:!1,success:function(t){var n;200===t.code&&(n=t.data.url,a.attr("src",n))}})}),t.trigger("click")})},AdSet.prototype.listenAddSubmitEvent=function(){$(".submit-btn").click(function(){var a=$(this),t=$(this).attr("data-location"),n=$(this).parents(".modal-content"),i=n.find(".thumbnail-btn").children("img").attr("src"),e=n.find('input[name="link_to"]').val(),d=n.find('input[name="hint"]').val(),o=$(this).attr("data-ad-id"),l=null,c=null,c="0"===o?(l="/cms/add_ad/","添加成功"):(l="/cms/edit_ad/","编辑成功"),s={image_url:i,link_to:e,hint:d,location:t};"0"!==o&&(s.id=o),myajax.post({url:l,data:s,success:function(t){var n;200===t.code&&(n=t.data.ad,window.messageBox.showSuccess(c),a.parents("div.thumbnail").find("img.thumbnail").attr("src",n.image_url),a.parents("div.thumbnail").find(".thumbnail-btn").children("img").attr("src",n.image_url),a.parents("div.thumbnail").find(".text-center").text(n.hint),a.siblings(".close-btn").trigger("click"))}})})},AdSet.prototype.run=function(){var t=this;t.initModal(),setTimeout(function(){t.listenChangeImageEvent(),t.listenAddSubmitEvent()},5e3)},$(function(){(new AdSet).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY21zL2FkX3NldC5taW4uanMiLCJzb3VyY2VzIjpbImNtcy9hZF9zZXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQWRTZXQoKXtcclxuXHJcbn1cclxuXHJcbi8vIOWIneWni+WMluaooeaAgee8lui+keahhlxyXG5BZFNldC5wcm90b3R5cGUuaW5pdE1vZGFsID0gZnVuY3Rpb24oKXtcclxuICAgIG15YWpheC5nZXQoe1xyXG4gICAgICAgICd1cmwnOiAnL2Ntcy9nZXRfYWRzLycsXHJcbiAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKXtcclxuICAgICAgICAgICAgICAgIHZhciBhZHMgPSByZXN1bHRbJ2RhdGEnXVsnYWRzJ107XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gWzAsMCwwLDBdO1xyXG4gICAgICAgICAgICAgICAgLy8g5bCG5bm/5ZGK5pS+5YWl5bm/5ZGK5qCPXHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPGFkcy5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHRlbXBsYXRlKCdhZGh0bWwnLHsnYWQnOmFkc1tpXX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGFkc1tpXS5sb2NhdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBhcnJbbG9jYXRpb24tMV0gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCJbZGF0YS1sb2NhdGlvbj0nXCIgKyBsb2NhdGlvbiArIFwiJ11cIikuYXBwZW5kKGh0bWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5bCG5bm/5ZGK5qCP5Li656m655qE6K6+572u5Y2g5L2N56ymXHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIG09MDttPDQ7bSsrKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihhcnJbbV0gPT09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmxhbmtBZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsb2NhdGlvbic6IG0gKyAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ltYWdlX3VybCc6ICcvc3RhdGljL2ltYWdlcy9ub3ZlbC9hZHZlcnRpc2VtZW50L2JsYW5rLnBuZycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGlua190byc6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hpbnQnOiAnJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpZCc6MFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYkh0bWwgPSB0ZW1wbGF0ZSgnYWRodG1sJyx7J2FkJzpibGFua0FkfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCJbZGF0YS1sb2NhdGlvbj0nXCIgKyAobSsxKSArIFwiJ11cIikuYXBwZW5kKGJIdG1sKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59O1xyXG5cclxuLy8g55uR5ZCs5Zu+54mH5pu05pS55LqL5Lu2XHJcbkFkU2V0LnByb3RvdHlwZS5saXN0ZW5DaGFuZ2VJbWFnZUV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciB0aHVtYm5haWxCdG4gPSAkKCcudGh1bWJuYWlsLWJ0bicpO1xyXG4gICAgY29uc29sZS5sb2codGh1bWJuYWlsQnRuKVxyXG4gICAgdGh1bWJuYWlsQnRuLmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGltZyA9ICQodGhpcykuY2hpbGRyZW4oJ2ltZycpO1xyXG4gICAgICAgIHZhciBmaWxlVGFnID0gJCh0aGlzKS5wYXJlbnRzKCcubW9kYWwtYm9keScpLmZpbmQoJy5pbWFnZS1maWxlJyk7XHJcbiAgICAgICAgZmlsZVRhZy5jaGFuZ2UoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSAkKHRoaXMpWzBdLmZpbGVzWzBdO1xyXG4gICAgICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJyxmaWxlKTtcclxuICAgICAgICAgICAgbXlhamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAgICAgJ3VybCc6ICcvY21zL3VwbG9hZF9maWxlLycsXHJcbiAgICAgICAgICAgICAgICAnZGF0YSc6IGZvcm1EYXRhLFxyXG4gICAgICAgICAgICAgICAgJ3Byb2Nlc3NEYXRhJzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAnY29udGVudFR5cGUnOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlX3VybCA9IHJlc3VsdFsnZGF0YSddWyd1cmwnXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW1nLmF0dHIoJ3NyYycsaW1hZ2VfdXJsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZmlsZVRhZy50cmlnZ2VyKFwiY2xpY2tcIik7XHJcbiAgICB9KVxyXG59O1xyXG5cclxuLy8g55uR5ZCs5bm/5ZGK5o+Q5Lqk5LqL5Lu2XHJcbkFkU2V0LnByb3RvdHlwZS5saXN0ZW5BZGRTdWJtaXRFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc3VibWl0QnRuID0gJCgnLnN1Ym1pdC1idG4nKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBzdWJtaXRCdG4gPSAkKHRoaXMpO1xyXG4gICAgICAgIHZhciBsb2NhdGlvbiA9ICQodGhpcykuYXR0cignZGF0YS1sb2NhdGlvbicpO1xyXG4gICAgICAgIHZhciBjb250ZW50ID0gJCh0aGlzKS5wYXJlbnRzKCcubW9kYWwtY29udGVudCcpO1xyXG4gICAgICAgIHZhciBpbWFnZV91cmwgPSBjb250ZW50LmZpbmQoJy50aHVtYm5haWwtYnRuJykuY2hpbGRyZW4oJ2ltZycpLmF0dHIoJ3NyYycpO1xyXG4gICAgICAgIHZhciBsaW5rX3RvID0gY29udGVudC5maW5kKCdpbnB1dFtuYW1lPVwibGlua190b1wiXScpLnZhbCgpO1xyXG4gICAgICAgIHZhciBoaW50ID0gY29udGVudC5maW5kKCdpbnB1dFtuYW1lPVwiaGludFwiXScpLnZhbCgpO1xyXG4gICAgICAgIHZhciBpZCA9ICQodGhpcykuYXR0cignZGF0YS1hZC1pZCcpO1xyXG4gICAgICAgIHZhciB1cmwgPSBudWxsO1xyXG4gICAgICAgIHZhciBtZXNzYWdlID0gbnVsbDtcclxuICAgICAgICBpZihpZCA9PT0gJzAnKXtcclxuICAgICAgICAgICAgdXJsID0gJy9jbXMvYWRkX2FkLyc7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSAn5re75Yqg5oiQ5YqfJztcclxuICAgICAgICB9IGVsc2V7XHJcbiAgICAgICAgICAgIHVybCA9ICcvY21zL2VkaXRfYWQvJztcclxuICAgICAgICAgICAgbWVzc2FnZSA9ICfnvJbovpHmiJDlip8nO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgJ2ltYWdlX3VybCc6IGltYWdlX3VybCxcclxuICAgICAgICAgICAgJ2xpbmtfdG8nOiBsaW5rX3RvLFxyXG4gICAgICAgICAgICAnaGludCc6IGhpbnQsXHJcbiAgICAgICAgICAgICdsb2NhdGlvbic6IGxvY2F0aW9uLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYoaWQgIT09ICcwJyl7XHJcbiAgICAgICAgICAgIGRhdGFbJ2lkJ10gPSBpZFxyXG4gICAgICAgIH1cclxuICAgICAgICBteWFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiB1cmwsXHJcbiAgICAgICAgICAgICdkYXRhJzogZGF0YSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ10gPT09IDIwMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFkID0gcmVzdWx0WydkYXRhJ11bJ2FkJ107XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MobWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3VibWl0QnRuLnBhcmVudHMoJ2Rpdi50aHVtYm5haWwnKS5maW5kKCdpbWcudGh1bWJuYWlsJykuYXR0cignc3JjJyxhZC5pbWFnZV91cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Ym1pdEJ0bi5wYXJlbnRzKCdkaXYudGh1bWJuYWlsJykuZmluZCgnLnRodW1ibmFpbC1idG4nKS5jaGlsZHJlbignaW1nJykuYXR0cignc3JjJyxhZC5pbWFnZV91cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1Ym1pdEJ0bi5wYXJlbnRzKCdkaXYudGh1bWJuYWlsJykuZmluZCgnLnRleHQtY2VudGVyJykudGV4dChhZFsnaGludCddKTtcclxuICAgICAgICAgICAgICAgICAgICBzdWJtaXRCdG4uc2libGluZ3MoJy5jbG9zZS1idG4nKS50cmlnZ2VyKFwiY2xpY2tcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BZFNldC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuaW5pdE1vZGFsKCk7XHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgc2VsZi5saXN0ZW5DaGFuZ2VJbWFnZUV2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5saXN0ZW5BZGRTdWJtaXRFdmVudCgpO1xyXG4gICAgfSw1MDAwKTtcclxufTtcclxuXHJcbiQoZnVuY3Rpb24oKXtcclxuICAgIHZhciBhZFNldCA9IG5ldyBBZFNldCgpO1xyXG4gICAgYWRTZXQucnVuKCk7XHJcbn0pOyJdLCJuYW1lcyI6WyJBZFNldCIsInByb3RvdHlwZSIsImluaXRNb2RhbCIsIm15YWpheCIsImdldCIsInVybCIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJhZHMiLCJhcnIiLCJpIiwibGVuZ3RoIiwiaHRtbCIsInRlbXBsYXRlIiwiYWQiLCJsb2NhdGlvbiIsIiQiLCJhcHBlbmQiLCJiSHRtbCIsIm0iLCJpbWFnZV91cmwiLCJsaW5rX3RvIiwiaGludCIsImlkIiwibGlzdGVuQ2hhbmdlSW1hZ2VFdmVudCIsInRodW1ibmFpbEJ0biIsImNvbnNvbGUiLCJsb2ciLCJjbGljayIsImltZyIsInRoaXMiLCJjaGlsZHJlbiIsImZpbGVUYWciLCJwYXJlbnRzIiwiZmluZCIsImNoYW5nZSIsImZpbGUiLCJmaWxlcyIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJwb3N0IiwiZGF0YSIsInByb2Nlc3NEYXRhIiwiY29udGVudFR5cGUiLCJhdHRyIiwidHJpZ2dlciIsImxpc3RlbkFkZFN1Ym1pdEV2ZW50Iiwic3VibWl0QnRuIiwiY29udGVudCIsInZhbCIsIm1lc3NhZ2UiLCJ3aW5kb3ciLCJtZXNzYWdlQm94Iiwic2hvd1N1Y2Nlc3MiLCJ0ZXh0Iiwic2libGluZ3MiLCJydW4iLCJzZWxmIiwic2V0VGltZW91dCJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsU0FLVEEsTUFBTUMsVUFBVUMsVUFBWSxXQUN4QkMsT0FBT0MsSUFBSSxDQUNQQyxJQUFPLGdCQUNQQyxR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
